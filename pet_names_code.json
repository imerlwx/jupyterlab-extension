{
    "0": "```R\\nlibrary(tidyverse)\\nlibrary(lubridate)\\ntheme_set(theme_light())\\n\\nseattle_pets <- readr::read_csv(\"https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-03-26/seattle_pets.csv\") %>%\\n  mutate(license_issue_date = mdy(license_issue_date)) %>%\\n  rename(animal_name = animals_name)\\n```",
    "1": "```R\\nseattle_pets %>%\\n  filter(license_issue_date >= \"2017-01-01\") %>%\\n  count(species, primary_breed, sort = TRUE) %>%\\n  filter(species %in% c(\"Cat\", \"Dog\")) %>%\\n  mutate(percent = n / sum(n)) %>%\\n  group_by(species) %>%\\n  top_n(10, percent) %>%\\n  ungroup() %>%\\n  mutate(primary_breed = fct_reorder(primary_breed, percent)) %>%\\n  ggplot(aes(primary_breed, percent, fill = species)) +\\n  geom_col(show.legend = FALSE) +\\n  scale_y_continuous(labels = scales::percent_format()) +\\n  facet_wrap(~ species, scales = \"free_y\", ncol = 1) +\\n  coord_flip() +\\n  labs(x = \"Primary breed\",\\n       y = \"% of this species\",\\n       title = \"Most common cat and dog breeds\",\\n       subtitle = \"Of licensed pets in Seattle 2017-2018\")\\n```",
    "3": "```R\\nname_breed_counts %>%\\n  filter(name_total >= 200,\\n         breed_total >= 200) %>%\\n  mutate(percent_of_breed = n / breed_total,\\n         percent_overall = name_total / nrow(dogs)) %>%\\n  mutate(overrepresented_ratio = percent_of_breed / percent_overall) %>%\\n  arrange(desc(overrepresented_ratio))\\n```",
    "5": "```R\\nhypergeom_test <- name_breed_counts %>%\\n  filter(name_total >= 200,\\n         breed_total >= 200) %>%\\n  mutate(percent_of_breed = n / breed_total,\\n         percent_overall = name_total / nrow(dogs)) %>%\\n  mutate(overrepresented_ratio = percent_of_breed / percent_overall) %>%\\n  arrange(desc(overrepresented_ratio)) %>%\\n  mutate(hypergeom_p_value = 1 - phyper(n,name_total, total_dogs - name_total, breed_total))\\n\\nggplot(hypergeom_test, aes(hypergeom_p_value)) +\\n  geom_histogram(binwidth = .05)\\n```",
    "6": "```R\\nname_counts <- dogs %>%\\n  group_by(animal_name) %>%\\n  summarize(name_total = n()) %>%\\n  filter(name_total >= 100)\\n\\nbreed_counts <- dogs %>%\\n  group_by(primary_breed) %>%\\n  summarize(breed_total = n()) %>%\\n  filter(breed_total >= 200)\\n\\ntotal_dogs <- nrow(dogs)\\n\\nname_breed_counts <- dogs %>%\\n  count(primary_breed, animal_name) %>%\\n  complete(primary_breed, animal_name, fill = list(n = 0)) %>%\\n  inner_join(name_counts, by = \"animal_name\") %>%\\n  inner_join(breed_counts, by = \"primary_breed\")\\n```",
    "8": "```R\\ncrossing(name_total = c(100, 200, 300),\\n         breed_total = seq(200, 1000, 25)) %>%\\n  mutate(max_p_value = 1 - phyper, name_total, total_dogs - name_total, breed_total)) %>%\\n  ggplot(aes(breed_total, max_pfvalue, color = factor(name_total))) +\\n  geom_line +\\n  labs(x = \"Total # of dogs in breed\",\\n       y = \"Maximum one-sided p-value\",\\n       color = \"# of dogs with name\")\\n```",
    "10": "```R\\nlibrary(scales)\\n\\nhypergeom_test %>%\\n  filter(fdr <= .05) %>%\\n  arrange(fdr) %>%\\n  transmute(`Breed` = primary_breed,\\n            `Name` = animal_name,\\n            `# of dogs with name` = n,\\n            `% of breed` = percent(percent_of_breed),\\n            `% overall` = percent(percent_overall),\\n            `FDR-adjusted one-sided p-value` = fdr) %>%\\n  knitr::kable()\\n```"
}